<div class="max-w-4xl mx-auto">
  <h2 class="text-3xl font-bold text-gray-800 mb-6">RAG System - Ask a Question</h2>

  <div class="bg-white rounded-lg shadow-md p-6 mb-6">
    <div class="mb-4">
      <label for="question" class="block text-sm font-medium text-gray-700 mb-2">
        Question:
      </label>
      <textarea
        id="question"
        [(ngModel)]="question"
        placeholder="e.g., What are WoW expansions?"
        rows="4"
        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all resize-none"
      ></textarea>
    </div>

    <button
      type="button"
      (click)="askQuestion()"
      [disabled]="loading()"
      class="px-8 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all duration-200 shadow-md hover:shadow-lg"
    >
      {{ loading() ? 'Searching...' : 'Ask' }}
    </button>
  </div>

  @if (hasError()) {
    <div class="bg-red-50 border-l-4 border-red-500 text-red-700 p-4 rounded-lg mb-6">
      <p class="font-medium">{{ error() }}</p>
    </div>
  }

  @if (hasResponse()) {
    <div class="space-y-6">
      <!-- Answer Section with GSAP Animation -->
      <div #answerContainer class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg shadow-lg p-6 border-l-4 border-green-600">
        <h3 class="text-2xl font-bold text-gray-800 mb-4">Answer</h3>
        <div #answerText class="text-gray-800 text-lg leading-relaxed">{{ response()?.answer }}</div>
      </div>

      <!-- Context Section with GSAP Animation -->
      <div class="bg-white rounded-lg shadow-lg p-6">
        <h4 class="text-xl font-bold text-gray-700 mb-4">Context Used</h4>
        <div #contextContainer class="space-y-3">
          @for (ctx of response()?.context; track $index) {
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border-l-4 border-blue-600 shadow-sm">
              <span class="text-sm font-bold text-blue-700">Source {{ $index + 1 }}:</span>
              <span class="ml-2 text-gray-700">{{ ctx }}</span>
            </div>
          }
        </div>
      </div>

      <!-- Blizzard Data Section -->
      @if (hasBlizzardData()) {
        <div class="bg-gray-900 rounded-lg shadow-lg p-6">
          <h4 class="text-xl font-bold text-white mb-4">Live Blizzard Data</h4>
          <pre class="text-green-400 text-sm overflow-x-auto">{{ response()?.blizzardData | json }}</pre>
        </div>
      }
    </div>
  }
</div>
